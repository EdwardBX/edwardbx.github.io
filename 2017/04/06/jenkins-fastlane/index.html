<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Objective-C,Ruby,iOS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="安装配置 CI 系列工具得益于 mac os 上的神器homebrew，我们可以很快的安装配置以下工具：

jenkins：持续集成界的明星项目，提供了工程自动化的服务端支持。
fastlane：ruby 编写的一套用于 iOS 自动化编译、打包、测试、发布的工具集合。
oclint：c / c++ / objc 代码质量静态检查工具，可自定义检查规范。
clang-format：批量化地对代码格">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 开发中的持续集成(CI)实践">
<meta property="og:url" content="http://edwardbx.github.io/2017/04/06/jenkins-fastlane/index.html">
<meta property="og:site_name" content="心辰·Dev">
<meta property="og:description" content="安装配置 CI 系列工具得益于 mac os 上的神器homebrew，我们可以很快的安装配置以下工具：

jenkins：持续集成界的明星项目，提供了工程自动化的服务端支持。
fastlane：ruby 编写的一套用于 iOS 自动化编译、打包、测试、发布的工具集合。
oclint：c / c++ / objc 代码质量静态检查工具，可自定义检查规范。
clang-format：批量化地对代码格">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 开发中的持续集成(CI)实践">
<meta name="twitter:description" content="安装配置 CI 系列工具得益于 mac os 上的神器homebrew，我们可以很快的安装配置以下工具：

jenkins：持续集成界的明星项目，提供了工程自动化的服务端支持。
fastlane：ruby 编写的一套用于 iOS 自动化编译、打包、测试、发布的工具集合。
oclint：c / c++ / objc 代码质量静态检查工具，可自定义检查规范。
clang-format：批量化地对代码格">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://edwardbx.github.io/2017/04/06/jenkins-fastlane/"/>





  <title> iOS 开发中的持续集成(CI)实践 | 心辰·Dev </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">心辰·Dev</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">iOS 开发小记</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://edwardbx.github.io/2017/04/06/jenkins-fastlane/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="BingXin Xue">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/12269628?v=3&u=f8fde6f61d60a77de9529887f1e954b99b8984fa&s=400">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="心辰·Dev">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="心辰·Dev" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS 开发中的持续集成(CI)实践
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-06T21:04:27+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="安装配置_CI_系列工具">安装配置 CI 系列工具</h3><p>得益于 mac os 上的神器<code>homebrew</code>，我们可以很快的安装配置以下工具：</p>
<ul>
<li>jenkins：持续集成界的明星项目，提供了工程自动化的服务端支持。</li>
<li>fastlane：ruby 编写的一套用于 iOS 自动化编译、打包、测试、发布的工具集合。</li>
<li>oclint：c / c++ / objc 代码质量静态检查工具，可自定义检查规范。</li>
<li>clang-format：批量化地对代码格式进行规范化。</li>
<li>xcpretty：格式化 xcodebuild 输出的工具。</li>
</ul>
<p>以上工具大多数可以用<code>brew install XXX</code>进行安装，具体步骤可参看各工具官方网站。</p>
<h4 id="jenkins_实用插件">jenkins 实用插件</h4><p>在安装好 jenkins 并运行后，可以对 jenkins 进行一系列配置。因为公司的项目代码集中管理在 SVN 服务上，下面会主要介绍针对 SVN 来进行 jenkins 的工程配置。在 jenkins 进行一次构建之前，需要将 SVN 上的最新代码拉到 jenkins 本地的 workspace 文件夹，所以需要让 jenkins 加载 SVN 的支持插件<a href="http://wiki.jenkins-ci.org/display/JENKINS/Subversion+Plugin" target="_blank" rel="external">Subversion Plug-in</a>。针对 iOS 工程的签名和打包，安装<a href="https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin" target="_blank" rel="external">Xcode integration</a>和<a href="http://wiki.jenkins-ci.org/display/JENKINS/Keychains+and+Provisioning+Profiles+Plugin" target="_blank" rel="external">Keychains and Provisioning Profiles Management</a>两个插件来使 jenkins 支持 iOS APP 的打包过程和证书管理。在 jenkins 运行一次构建之后，一般还希望运行一些脚本来进行更多的操作，那么还需要加载一个插件<a href="http://wiki.jenkins-ci.org/display/JENKINS/PostBuildScript+Plugin" target="_blank" rel="external">Post-Build Script Plug-in</a>。插件<a href="http://wiki.jenkins-ci.org/display/JENKINS/AnsiColor+Plugin" target="_blank" rel="external">AnsiColor</a>会使 jenkins 的控制台输出可读性更高，插件<a href="http://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin" target="_blank" rel="external">HTML Publisher plugin</a>可以帮助快速生成 fastlane / oclint 运行结果报告到 workspace 的首页。以上插件都提高 iOS 工程持续集成的效率，还有更多插件有待探索。</p>
<p>安装好插件后，通常在 jenkins 的系统设置页面中会添加相应的待设置的栏目。例如，安装了<a href="http://wiki.jenkins-ci.org/display/JENKINS/Keychains+and+Provisioning+Profiles+Plugin" target="_blank" rel="external">Keychains and Provisioning Profiles Management</a>插件后，要在系统设置页面对证书和许可文件信息进行完善。要注意这里需要导入的是含有证书的钥匙串文件，一般位于<code>/Users/Username/Library/keychains/login.keychain</code>，也可以重新在<code>钥匙串.app</code>添加一个只用于 jenkins 的钥匙串并上传。项目的<code>Provisioning Profiles</code>可以从 XCode 的 Preferences —&gt; Accounts —&gt; Apple IDs 找到。<br><a id="more"></a></p>
<h3 id="fastlane_实用工具">fastlane 实用工具</h3><p>fastlane 是一套自动化工具的集合，极大地方便了我们执行和配置命令行任务。在 jenkins 的构建过程中，可以运行自定义的 shell 脚本，这就给 fastlane 和 jenkins 的紧密结合提供了条件。fastlane iOS 套件共包含 13 种工具：deliver(APP Store 快速发布) / snapshot(APP Store 各分辨率截图) / frameit(在 snapshot 基础上添加各种设备的框架) / pem(更新推送证书) / sigh(管理 Provisioning Profiles) / produce(在 iTunes Connect 创建新项目) / cert(管理代码签名证书) / spaceship(访问 iTunes Connect 和 开发者中心) / pilot(管理 TestFlight 测试) / boarding(邀请 TestFlight beta 测试用户) / gym(自动化编译) / match(用 Git 管理证书文件) / scan (自动化测试)。<br>下面详细介绍 fastlane 工具链中的几个常用组成部分。</p>
<h4 id="gym">gym</h4><p>gym 是 iOS 应用编译和打包的工具。在比较了 facebook 开源项目 xctool 之后，发现 gym 的便捷性和自动化程度都略胜一筹。其主要是用脚本简化了 xcodebuild 命令行工具的使用，将相关配置信息统一存入 Gymfile 进行管理。例如，以前想要打包并导出 ipa 可以在命令行运行以下命令：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild clean archive -archivePath build/MyApp \</span><br><span class="line">-<span class="ruby">scheme <span class="constant">MyApp</span></span><br><span class="line"></span></span><br><span class="line">xcodebuild -exportArchive \</span><br><span class="line">-<span class="ruby">exportFormat ipa \</span><br><span class="line"></span>-<span class="ruby">archivePath <span class="string">"build/MyApp.xcarchive"</span> \</span><br><span class="line"></span>-<span class="ruby">exportPath <span class="string">"build/MyApp.ipa"</span> \</span><br><span class="line"></span>-<span class="ruby">exportProvisioningProfile <span class="string">"ProvisioningProfileName"</span></span></span><br></pre></td></tr></table></figure>
<p>而现在只需要<code>fastlane gym</code>命令即可完成编译和打包的任务。</p>
<h5 id="gym_的使用">gym 的使用</h5><p>gym 的使用非常简单，如针对特定的 Scheme 编译，可运行以下命令：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane gym --scheme &#34;AppName&#34; --clean</span><br></pre></td></tr></table></figure>
<p>运行这个命令，其实整个过程是对 xcodebuild 一系列命令的自动化运行。先运行了 <code>xcodebuild -list</code> 和 <code>xcodebuild clean -showBuildSettings</code>得到了项目的 target / schemes / build settings 等信息，然后运行</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -o pipefail &#38;&#38; xcodebuild -scheme AppName -project ./Example.xcodeproj -destination &#39;generic/platform=iOS&#39; -archivePath /archivePath/build/xxx/xxx.xcarchive clean archive | xcpretty</span><br></pre></td></tr></table></figure>
<p>编译结束后，如果项目配置了签名信息，会进行代码签名并打包成 AppName.app 至指定输出目录(如没有特殊配置，则为项目根目录)，随后还会生成一个压缩好的 DSYM 文件和 ipa 安装文件。如果想在编译时得到更多的信息，可以在运行 gym 命令时添加<code>--verbose</code>选项。输出的信息是经过 xcpretty 格式化的，具有可读性。</p>
<h5 id="Gymfile">Gymfile</h5><p>每次手动输入信息并运行 gym 命令略显麻烦，可以先把每次默认的信息添加到 Gymfile 中。<br>在项目目录运行<code>fastlane gym init</code>会得到一个新的 Gymfile。可添加如下信息到 Gymfile:</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">scheme</span> <span class="string">"AppName"</span></span><br><span class="line"></span><br><span class="line">sdk <span class="string">"iphoneos9.0"</span></span><br><span class="line"></span><br><span class="line">clean <span class="built_in">true</span></span><br><span class="line"></span><br><span class="line">output_directory <span class="string">"./build"</span></span><br><span class="line">output_name <span class="string">"AppName"</span></span><br></pre></td></tr></table></figure>
<h4 id="scan">scan</h4><p>scan 工具可以在模拟器或连接设备上自动化运行测试，和 fastlane 其他命令一样，它对用户隐藏了苹果官方复杂的命令行工具的使用细节，用 ruby 脚本完成自动化配置和执行。它和 gym 一样都是由<code>xcodebuild</code>和<code>xcpretty</code>两大部分组成。</p>
<h5 id="scan_的使用">scan 的使用</h5><p>简单在命令行运行即可：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane scan</span><br></pre></td></tr></table></figure>
<p>想要在指定模拟器设备上运行测试，只需要在 fastlane 命令里指定参数<code>--device</code>：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane scan --scheme &#34;AppName&#34; --device &#34;iPhone 6&#34; --clean</span><br></pre></td></tr></table></figure>
<p>当运行 scan 命令时，先取得项目的 target / schemes / build settings 等信息，然后找到 Scanfile 中或命令行参数中指定的设备名，对运行测试的各个参数进行汇总。准备就绪后运行：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -o pipefail &#38;&#38; env NSUnbufferedIO=YES xcodebuild -scheme AppName -project ./Example.xcodeproj -destination &#39;platform=iOS Simulator,id=XXXxxx&#39; -derivedDataPath &#39;/Users/XXX/.../DerivedData/Example-xxxx&#39; build test | xcpretty</span><br></pre></td></tr></table></figure>
<p>运行测试过程中，会把日志保存到 XCode 的 DerivedData 文件夹。当测试完成，会生成最终的结果汇总如下图。根据默认选项，还会生成 html 的测试报告，以供用户查看。</p>
<h5 id="Scanfile">Scanfile</h5><p>在项目目录运行<code>fastlane scan init</code>会得到一个新的 Scanfile，可以编辑其内容指定默认配置：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scheme <span class="string">"AppName"</span></span><br><span class="line">devices [<span class="string">"iPhone 6s"</span>, <span class="string">"iPhone 6"</span>]</span><br><span class="line">clean <span class="keyword">true</span></span><br><span class="line"></span><br><span class="line">output_types <span class="string">"html"</span></span><br></pre></td></tr></table></figure>
<h4 id="snapshot">snapshot</h4><p>如今 iOS 设备数逐年增加，提高了适配的难度，也经常会有在多个设备上进行截图的需求。如直观检验 App 在各种设备上的实际 UI 效果与设计图的差别，或者 Apple Store 上架时提供多种类型尺寸的 APP 截屏图片。本来这一任务需要手动进行，重复性劳动多，而借助 snapshot 可以较好地自动完成。</p>
<h5 id="snapshot_的使用">snapshot 的使用</h5><ul>
<li><p>首先在工程添加一个新的 UI Test target.</p>
</li>
<li><p>在项目根目录执行 <code>fastlane snapshot init</code>。</p>
</li>
<li><p>上一步骤会自动生成文件 <code>./SnapshotHelper.swift</code>，把它加入到 UI Test target.</p>
</li>
<li><p>在 UI Test target 编译设置里把<code>Enable Modules</code>改为<code>Yes</code>。</p>
</li>
<li><p>在”MyUITests.m”文件中导入桥接头文件<code>#import &quot;MYUITests-Swift.h&quot;</code>。这样在这个文件里才能使用 Swift 代码。需要注意的是，<code>MYUITests-Swift.h</code>不需要手动生成，导入之后就能使用所有工程中的 Swift 代码。</p>
</li>
<li><p>在 UI Test 类文件里，点击 Xcode 界面左下方的录制按钮，启动模拟器，在模拟器上操作想要测试的动作，测试代码会自动生成。</p>
</li>
<li><p>在测试代码中，可以插入如下代码进行截屏：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Swift</span>: <span class="function">snapshot</span>(<span class="string">"01Screen"</span>)</span><br><span class="line">Objective <span class="attribute">C</span>: [Snapshot <span class="attribute">snapshot</span>:@<span class="string">"01Screen"</span> <span class="attribute">waitForLoadingIndicator</span>:YES];</span><br></pre></td></tr></table></figure>
</li>
<li><p>在测试类中的<code>setUp()</code>方法中添加：</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="name">XCUIApplication</span> *<span class="atom">app</span> = [[<span class="name">XCUIApplication</span> <span class="atom">alloc</span>] <span class="atom">init</span>];</span><br><span class="line">[<span class="name">Snapshot</span> <span class="atom">setupSnapshot</span>:<span class="atom">app</span>];</span><br><span class="line">[<span class="atom">app</span> <span class="atom">launch</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后运行<code>fastlane snapshot</code>开始截图。snapshot 的命令还有多种参数可以指定，如遇到错误立即停止：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane snapshot --stop_after_first_errorsnapshot</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>同样支持编辑 Snapfile 来指定默认的设置。</p>
<h5 id="snapshot_原理">snapshot 原理</h5><p>当 XCode 运行 UI 测试时，会生成一个 plist 记录发生的事件，在每个事件之前、之中、之后 XCode 都会生成截图。这些截图会被保存在一个临时文件夹。如果在测试类中调用<code>snapshot()</code>时， snapshot 会进行一次转向 .Unknown 的旋转，表面上这不会引起任何改变，但是它会触发截屏。然后 snapshot 会遍历所有事件，找到这个旋转事件和它对应的截图。</p>
<h3 id="fastlane_自动化工作流">fastlane 自动化工作流</h3><h4 id="Fastfile_任务描述">Fastfile 任务描述</h4><p>fastlane 工具套件的出色之处不仅在于它们单个组件都有强大的功能，还在于通过一个 Fastfile 能将各种工具整合，形成完整的编译—&gt;测试—&gt;打包的自动化工作流。如在 fastlane 工作流中实现一次 release 版本的打包和 APP Store 分发过程，只需编辑 Fastfile 内容，用 fastlane 的 DSL 描述一系列自动化任务：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">desc "Deploys a new version to the App Store"</span><br><span class="line">lane :<span class="operator"><span class="keyword">release</span> <span class="keyword">do</span></span><br><span class="line">    increment_build_number</span><br><span class="line">    cocoapods</span><br><span class="line">    <span class="keyword">snapshot</span></span><br><span class="line">    <span class="keyword">match</span></span><br><span class="line">    gym(configuration: <span class="string">"Release"</span>)</span><br><span class="line">    deliver(<span class="keyword">force</span>:<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">end</span></span></span><br></pre></td></tr></table></figure>
<p>保存 Fastfile 到指定位置<code>./fastlane/Fastfile</code>后，命令行运行<code>fastlane release</code>即可自动运行上述过程。注意到这个自动化过程结合了上文提到的 snapshot 和 gym 工具，还用到了 fastlane 的其它工具套件如 match / deliver 等。而<code>increment_build_number</code>和<code>cocoapods</code>这两行分别对应了 fastfile 中的一个动作(action)，即递增版本号，安装项目的 cocoapods 依赖。fastlane 本身定义了很多类似的细粒度的动作，每个动作对应了一个 ruby 脚本，基本支持了持续集成过程中常见的操作。但如果这些动作脚本并没有涵盖实际工作中的需要，就要自己去创建一个动作，也就是 fastlane 提供的自定义动作的机制。</p>
<h4 id="fastlane_自定义_Action">fastlane 自定义 Action</h4><p>fastlane 目前包含的 action 有 180 个之多(version 2.24.0)，基本涵盖了持续集成的需求。由于目前公司是使用 SVN 来管理 cocoapods 的私有 repo，在编写 pods 代码 —&gt; 验证有效性 —&gt; 推 pods 到服务器这一工作流中，需要使用 cocoapods 的 SVN 支持插件，执行的命令与 fastlane 自带的 cocoapods 相关 action 有所不同。那么就要自定义一些 action 来支持 pods 开发体系中的自动化上传 —&gt; 验证 —&gt; 工程构建的过程。    </p>
<p>首先在项目根目录，运行：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane new_action</span><br></pre></td></tr></table></figure>
<p>会提示输入 action 的名称。输入后回车，fastlane 会在项目目录<code>./fastlane/actions</code>生成一个相应名字的 ruby 脚本。打开之后发现其实是一个模板，只要摸清模板的结构，就能轻松地自定义 action 去运行指定命令。为了支持 SVN 管理的私有 pods 的上传(push)工作，下面为修改后的 action 脚本：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Fastlane</span></span></span><br><span class="line">  <span class="class"><span class="keyword">module</span> <span class="title">Actions</span></span></span><br><span class="line">    <span class="class"><span class="keyword">module</span> <span class="title">SharedValues</span></span></span><br><span class="line">      <span class="constant">SVNPOD_PUSH_CUSTOM_VALUE</span> = <span class="symbol">:SVNPOD_PUSH_CUSTOM_VALUE</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SvnpodPushAction</span> <span class="inheritance">&lt; <span class="parent">Action</span></span></span></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.run(params)</span><br><span class="line">        <span class="comment"># fastlane will take care of reading in the parameter and fetching the environment variable:</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># sh "shellcommand ./path"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Actions.lane_context[SharedValues::SVNPOD_PUSH_CUSTOM_VALUE] = "my_val"</span></span><br><span class="line">        <span class="comment"># 上传 pods 的命令： pod repo-svn push #&#123;repo&#125;</span></span><br><span class="line">        <span class="keyword">if</span> params[<span class="symbol">:repo</span>]</span><br><span class="line">            repo = params[<span class="symbol">:repo</span>]</span><br><span class="line">            command = <span class="string">"pod repo-svn push <span class="subst">#&#123;repo&#125;</span>"</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            command = <span class="string">'pod trunk push'</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment"># 拼接后面的参数</span></span><br><span class="line">        <span class="keyword">if</span> params[<span class="symbol">:path</span>]</span><br><span class="line">            command &lt;&lt; <span class="string">" '<span class="subst">#&#123;params[<span class="symbol">:path</span>]&#125;</span>'"</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> params[<span class="symbol">:silent</span>]</span><br><span class="line">            command &lt;&lt; <span class="string">" --silent"</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> params[<span class="symbol">:verbose</span>]</span><br><span class="line">            command &lt;&lt; <span class="string">" --verbose"</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">      	</span><br><span class="line">        <span class="comment"># 运行脚本</span></span><br><span class="line">        result = <span class="constant">Actions</span>.sh(command.to_s)</span><br><span class="line">        <span class="constant">UI</span>.success(<span class="string">"pushed Podspec to svn ⬆️ "</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#####################################################</span></span><br><span class="line">      <span class="comment"># @!group Documentation</span></span><br><span class="line">      <span class="comment">#####################################################</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.description</span><br><span class="line">        <span class="string">"Push a Podspec to Trunk or a svn private repository"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.details</span><br><span class="line">        <span class="comment"># Optional:</span></span><br><span class="line">        <span class="comment"># this is your chance to provide a more detailed description of this action</span></span><br><span class="line">        <span class="string">"You can use this action to push a Podspec..."</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.available_options</span><br><span class="line">        <span class="comment"># Define all options your action supports. </span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Below a few examples</span></span><br><span class="line">        [</span><br><span class="line">            <span class="constant">FastlaneCore::ConfigItem</span>.new(<span class="symbol">key:</span> <span class="symbol">:path</span>,</span><br><span class="line">                                         <span class="symbol">description:</span> <span class="string">"The Podspec you want to push"</span>,</span><br><span class="line">                                         <span class="symbol">optional:</span> <span class="keyword">true</span>,</span><br><span class="line">                                         <span class="symbol">verify_block:</span> proc <span class="keyword">do</span> |value|</span><br><span class="line">                                         <span class="constant">UI</span>.user_error!(<span class="string">"Couldn't find file at path '<span class="subst">#&#123;value&#125;</span>'"</span>) <span class="keyword">unless</span> <span class="constant">File</span>.exist?(value)</span><br><span class="line">                                         <span class="constant">UI</span>.user_error!(<span class="string">"File must be a `.podspec` or `.podspec.json`"</span>) <span class="keyword">unless</span> value.end_with?(<span class="string">".podspec"</span>, <span class="string">".podspec.json"</span>)</span><br><span class="line">                                         <span class="keyword">end</span>),</span><br><span class="line">            <span class="constant">FastlaneCore::ConfigItem</span>.new(<span class="symbol">key:</span> <span class="symbol">:repo</span>,</span><br><span class="line">                                         <span class="symbol">description:</span> <span class="string">"The repo you want to push. Pushes to Trunk by default"</span>,</span><br><span class="line">                                         <span class="symbol">optional:</span> <span class="keyword">true</span>),</span><br><span class="line">            <span class="constant">FastlaneCore::ConfigItem</span>.new(<span class="symbol">key:</span> <span class="symbol">:silent</span>,</span><br><span class="line">                                         <span class="symbol">description:</span> <span class="string">"Show nothing"</span>,</span><br><span class="line">                                         <span class="symbol">optional:</span> <span class="keyword">true</span>,</span><br><span class="line">                                         <span class="symbol">is_string:</span> <span class="keyword">false</span>),</span><br><span class="line">            <span class="constant">FastlaneCore::ConfigItem</span>.new(<span class="symbol">key:</span> <span class="symbol">:verbose</span>,</span><br><span class="line">                                         <span class="symbol">description:</span> <span class="string">"Show more debugging information"</span>,</span><br><span class="line">                                         <span class="symbol">optional:</span> <span class="keyword">true</span>,</span><br><span class="line">                                         <span class="symbol">is_string:</span> <span class="keyword">false</span>,</span><br><span class="line">                                         <span class="symbol">default_value:</span> <span class="keyword">false</span>)</span><br><span class="line">        ]</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.output</span><br><span class="line">        <span class="comment"># Define the shared values you are going to provide</span></span><br><span class="line">        <span class="comment"># Example</span></span><br><span class="line">        [</span><br><span class="line">          [<span class="string">'SVNPOD_PUSH_CUSTOM_VALUE'</span>, <span class="string">'A description of what this value contains'</span>]</span><br><span class="line">        ]</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.return_value</span><br><span class="line">        <span class="comment"># If you method provides a return value, you can describe here what it does</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.authors</span><br><span class="line">        <span class="comment"># So no one will ever forget your contribution to fastlane :) You are awesome btw!</span></span><br><span class="line">        [<span class="string">"EastMoney/xuebingxin"</span>]</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.is_supported?(platform)</span><br><span class="line">        <span class="comment"># you can do things like</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="comment">#  true</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="comment">#  platform == :ios</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="comment">#  [:ios, :mac].include?(platform)</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line"></span><br><span class="line">        [<span class="symbol">:ios</span>, <span class="symbol">:mac</span>].<span class="keyword">include</span>? platform</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>编辑好脚本后，就可以在 Fastfile 方便地使用这一动作。fastlane 这一机制使其更好地与第三方持续集成工具进行结合，糅合了更多的第三方工具到 fastlane 工作流中。</p>
<h3 id="jenkins_构建选项">jenkins 构建选项</h3><p>在熟悉了 fastlane 工具链和 Fastfile 的编写后，就可以把 fastlane 运用于 jenkins 的工程构建中。       </p>
<h4 id="构建中">构建中</h4><p>jenkins 创建一个 iOS 工程后，应首先对工程进行正确的配置。要确保 jenkins 有能力访问 svn 服务器的地址，并选择该工程构建所需的开发证书、发布证书和许可文件。对其他的配置选项如有不清楚的地方，可以点击最右侧的问号按钮，来详细地了解它的作用。在构建选项设置模块，在<code>Execute shell</code>中填写命令行命令如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane release</span><br></pre></td></tr></table></figure>
<p>再在 jenkins 项目首页左边栏点击构建，就会自动运行 Fastfile 中的 release lane, 进行一次 release 版本的自动化操作。                 </p>
<p>持续集成主要完成自动化打包、自动化测试、静态代码分析、自动化部署等任务，release lane 其实就是一次自动化打包和部署的过程。先递增版本号，再安装项目的 cocoapods 依赖，对工程进行编译并截图准备提交到 APP Store 的图片，然后自动化打包成 APP Store ipa 包，并发布到应用商店。       </p>
<p>借助 fastlane 和 jenkins，还可以很轻松地运行自动化测试和静态代码分析。在 Fastfile 中定义一个 lane 如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lane <span class="symbol">:test</span> <span class="keyword">do</span></span><br><span class="line">    clang_format</span><br><span class="line">    sh <span class="string">"cd .. &amp;&amp; ./oclint_ci.sh"</span></span><br><span class="line">    scan</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>clang_format 是自定义的 action, 用来规范化代码格式。主要就是遍历工程根目录下的 .h / .m 文件，对其运行命令即可：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang-format -i localpath -style=File</span><br></pre></td></tr></table></figure>
<p>scan 上文已经分析，它最终可以生成 html 形式的测试报告。      </p>
<p><code>oclint_ci.sh</code>是运用 oclint 来进行静态代码分析的脚本：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">echo "xcodebuild clean"</span><br><span class="line">xcodebuild clean -scheme BXiOSCollection</span><br><span class="line">echo "xcodebuild analyze | tee xcodebuild.log | xcpretty --report json-compilation-database"</span><br><span class="line"></span><br><span class="line"># 生成 xcodebuild.log 和 json-compilation-database</span><br><span class="line">xcodebuild -scheme BXiOSCollection analyze | tee xcodebuild.log | \</span><br><span class="line">xcpretty --report json-compilation-database</span><br><span class="line"></span><br><span class="line"># 把生成的 compilation_db.json 移动到根目录并命名为 compile_commands.json</span><br><span class="line">echo "mv compilation_db.json compile_commands.json"</span><br><span class="line">mv ./build/reports/compilation_db.json ./compile_commands.json</span><br><span class="line"></span><br><span class="line"># 用规则进行检查，生成 oclint.html 报告</span><br><span class="line">echo "oclint-json-compilation-database"</span><br><span class="line">oclint-json-compilation-database \</span><br><span class="line">-<span class="ruby">e <span class="constant">Pods</span> \</span><br><span class="line"></span>-<span class="ruby">- \</span><br><span class="line"></span>-<span class="ruby">stats \</span><br><span class="line"></span>-<span class="ruby">verbose \</span><br><span class="line"></span>-<span class="ruby">report-type=html -o=oclint/oclint.html \</span><br><span class="line"></span>-<span class="ruby">max-priority-<span class="number">1</span>=<span class="number">999</span> -max-priority-<span class="number">2</span>=<span class="number">9999</span> -max-priority-<span class="number">3</span>=<span class="number">99999</span> \</span><br><span class="line"></span>-<span class="ruby">rc <span class="constant">LONG_LINE</span>=<span class="number">200</span> \</span><br><span class="line"></span>-<span class="ruby">rc <span class="constant">LONG_METHOD</span>=<span class="number">100</span> \</span><br><span class="line"></span>-<span class="ruby">rc <span class="constant">LONG_VARIABLE_NAME</span>=<span class="number">40</span> \</span><br><span class="line"></span>-<span class="ruby">disable-rule=<span class="constant">BrokenOddnessCheck</span> \</span></span><br></pre></td></tr></table></figure>
<p>更多的 -disable-rule 选项可以参见 oclint 的官方文档。</p>
<h4 id="构建后">构建后</h4><p>在运行完 test lane 之后在项目目录生成了静态代码检查报告。报告的文件形式为 html 网页，通过添加 post build —&gt; Publish HTML Reports 可以很方便地将该网页形式的报告发布在项目 workspace 的首页，只需要在 HTML directory to archive 空格处填写 html 归档的路径即可，如下图所示：     </p>
<p>至此，基于 jenkins 服务端和 fastlane 脚本工具的持续集成方案得到了实践和验证。通过在实际应用中不断完善这一方案，iOS APP 的编译、测试、打包、发布等流程都实现了高度的自动化，给团队的开发效率提高了一个台阶。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Objective-C/" rel="tag"># Objective-C</a>
          
            <a href="/tags/Ruby/" rel="tag"># Ruby</a>
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/07/behaviordd/" rel="next" title="iOS 应用 UI 测试开发概览">
                <i class="fa fa-chevron-left"></i> iOS 应用 UI 测试开发概览
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars1.githubusercontent.com/u/12269628?v=3&u=f8fde6f61d60a77de9529887f1e954b99b8984fa&s=400"
               alt="BingXin Xue" />
          <p class="site-author-name" itemprop="name">BingXin Xue</p>
           
              <p class="site-description motion-element" itemprop="description">薛冰心的博客</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/EdwardBX" target="_blank" title="github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/5106446763" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.douban.com/people/127211499/" target="_blank" title="douban">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  douban
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/xbx2014" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装配置_CI_系列工具"><span class="nav-number">1.</span> <span class="nav-text">安装配置 CI 系列工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jenkins_实用插件"><span class="nav-number">1.1.</span> <span class="nav-text">jenkins 实用插件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fastlane_实用工具"><span class="nav-number">2.</span> <span class="nav-text">fastlane 实用工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#gym"><span class="nav-number">2.1.</span> <span class="nav-text">gym</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#gym_的使用"><span class="nav-number">2.1.1.</span> <span class="nav-text">gym 的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gymfile"><span class="nav-number">2.1.2.</span> <span class="nav-text">Gymfile</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scan"><span class="nav-number">2.2.</span> <span class="nav-text">scan</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#scan_的使用"><span class="nav-number">2.2.1.</span> <span class="nav-text">scan 的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Scanfile"><span class="nav-number">2.2.2.</span> <span class="nav-text">Scanfile</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snapshot"><span class="nav-number">2.3.</span> <span class="nav-text">snapshot</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#snapshot_的使用"><span class="nav-number">2.3.1.</span> <span class="nav-text">snapshot 的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#snapshot_原理"><span class="nav-number">2.3.2.</span> <span class="nav-text">snapshot 原理</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fastlane_自动化工作流"><span class="nav-number">3.</span> <span class="nav-text">fastlane 自动化工作流</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Fastfile_任务描述"><span class="nav-number">3.1.</span> <span class="nav-text">Fastfile 任务描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fastlane_自定义_Action"><span class="nav-number">3.2.</span> <span class="nav-text">fastlane 自定义 Action</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jenkins_构建选项"><span class="nav-number">4.</span> <span class="nav-text">jenkins 构建选项</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#构建中"><span class="nav-number">4.1.</span> <span class="nav-text">构建中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#构建后"><span class="nav-number">4.2.</span> <span class="nav-text">构建后</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BingXin Xue</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


</body>
</html>
